<h1>hELLO</h1>
<div id="recently-played-panel" class="container-fluid home-panel">
    <div class="container">
        <div id="recently-played-container">
            <div>
                <h4 class="panel-title">Recently Played</h4>
                <div class="selectors">
                    <i onclick="scrollPanelLeft('#recently-played')" class="fa fa-chevron-left fa-lg"
                        aria-hidden="true"></i>
                    <i onclick="scrollPanelRight('#recently-played')" class="fa fa-chevron-right fa-lg"
                        aria-hidden="true"></i>
                </div>
            </div>
            <section class="container row panel-container" id="recently-played">
                {{#each items}}
                <section id="col-sm media-content">
                    <img class="media-object album-cover" width="150" height="150"
                        src="{{this.track.album.images.1.url}}" />
                    <div class="album-data">
                        {{this.track.name}}
                    </div>
                    <div class="album-data">
                        {{this.track.artists.0.name}}
                    </div>
                </section>
                {{/each}}
            </section>
        </div>
    </div>
</div>

<div id="top-artists-panel" class="container-fluid home-panel">
    <div class="container">
        <div id="top-artists-container">
        </div>
    </div>
</div>

<div id="new-releases-panel" class="container-fluid home-panel">
    <div class="container">
        <div id="new-releases-container">
        </div>
    </div>
</div>

<div id="featured-playlists-panel" class="container-fluid home-panel">
    <div class="container">
        <div id="featured-playlists-container">
        </div>
    </div>
</div>

<script id="user-name-template" type="text/x-handlebars-template">
    <a class="navbar-brand" href="#">hello-{{display_name}}</a>
  </script>

{{!-- <script id="recently-played-template" type="text/x-handlebars-template">

    </script> --}}

{{!-- <script id="top-artists-template" type="text/x-handlebars-template">
    <div>
          <h4 class="panel-title">Top Artists</h4>
          <div class="selectors">
              <i onclick="scrollPanelLeft('#top-artists')" class="fa fa-chevron-left fa-lg" aria-hidden="true"></i>
              <i onclick="scrollPanelRight('#top-artists')" class="fa fa-chevron-right fa-lg" aria-hidden="true"></i>
          </div>
        </div>
        <section class="container row panel-container" id="top-artists">
          {{#each items}}
          <section id="col-sm media-content">
            <img class="media-object album-cover" width="150" height="150" src="{{this.images.1.url}}" />
            <div class="album-data">
              {{this.name}}
            </div>
          </section>
          {{/each}}
        </section>
    </script>

<script id="new-releases-template" type="text/x-handlebars-template">
    <div>
        <h4 class="panel-title">New Releases</h4>
        <div class="selectors">
            <i onclick="scrollPanelLeft('#new-releases')" class="fa fa-chevron-left fa-lg" aria-hidden="true"></i>
            <i onclick="scrollPanelRight('#new-releases')" class="fa fa-chevron-right fa-lg" aria-hidden="true"></i>
        </div>
    </div>
      <section class="container row panel-container" id="new-releases">
        {{#each items}}
        <section id="col-sm media-content">
          <img class="media-object album-cover" width="150" height="150" src="{{this.images.1.url}}" />
          <div class="album-data">
            {{this.name}}
          </div>
        </section>
        {{/each}}
      </section>
  </script>

<script id="featured-playlists-template" type="text/x-handlebars-template">
    <div>
      <h4 class="panel-title">Featured Playlists</h4>
      <div class="selectors">
          <i onclick="scrollPanelLeft('#featured-playlists')" class="fa fa-chevron-left fa-lg" aria-hidden="true"></i>
          <i onclick="scrollPanelRight('#featured-playlists')" class="fa fa-chevron-right fa-lg" aria-hidden="true"></i>
      </div>
    </div>
    <section class="container row panel-container" id="featured-playlists">
      {{#each items}}
      <section id="col-sm media-content">
        <img class="media-object album-cover" width="150" height="150" src="{{this.images.0.url}}"/>
          <div class="album-data">
            {{this.name}}         
          </div>
      </section>
      {{/each}}
    </section>
</script> --}}

<script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>


<script>
    (function () {
        /**
         * Obtains parameters from the hash of the URL
         * @return Object
         */
        function getHashParams() {
            var hashParams = {};
            var e, r = /([^&;=]+)=?([^&;]*)/g,
                q = window.location.hash.substring(1);
            while (e = r.exec(q)) {
                hashParams[e[1]] = decodeURIComponent(e[2]);
            }
            return hashParams;
        }
        var params = getHashParams();

        var access_token = params.access_token,
            refresh_token = params.refresh_token,
            error = params.error;

        if (error) {
            // TODO don't have an alert here. 
            alert('There was an error during the authentication');
        } else {
            if (access_token) {
                SpotifyApiWrapper.fetchUserProfile(access_token);
                SpotifyApiWrapper.fetchTopArtists(access_token);
                SpotifyApiWrapper.fetchRecentlyPlayed(access_token);
                SpotifyApiWrapper.fetchNewReleases(access_token);
                SpotifyApiWrapper.fetchFeaturedPlaylists(access_token);
            } else {
                // render initial screen
                $('#login').show();
                $('#logout-button').hide();
                $('#loggedin').hide();
                $('#top-artists-panel').hide();
                $('#recently-played-panel').hide();
                $('#featured-playlists-panel').hide();
                $('#new-releases-panel').hide();

                $('#user-name').hide();
                //TODO fix this
                // var navigationLinks = document.getElementsByClassName('.navigation-link');
                //   navigationLinks.array.forEach(element => {
                //   element.classList.add('disabled');
                // });
            }
        }
    })();
</script>

<script>
    function scrollPanelRight(element) {
        $(element).animate({
            scrollLeft: '+=600'
        }, 500);
    };

    function scrollPanelLeft(element) {
        $(element).animate({
            scrollLeft: '-=600'
        }, 500);
    };
</script>